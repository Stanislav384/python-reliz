-- Paths to the items
local WallClose = game.Workspace:WaitForChild("Teleports"):WaitForChild("WallClose")
local key1 = game.Workspace:WaitForChild("Key1")
local key2 = game.Workspace:WaitForChild("Key2")
local key3 = game.Workspace:WaitForChild("Key3")

-- Use a simple counter to track collected keys
local keysCollected = 0

-- A single function that handles the 'Touched' event for all keys
local function onKeyTouched(touchedKey, otherPart)
	local player = game.Players:GetPlayerFromCharacter(otherPart.Parent)

	-- Check if a player touched the key and if the key hasn't been collected yet
	if player and touchedKey.CanCollide == true then

		-- Make the key disappear
		touchedKey.CanCollide = false
		touchedKey.Transparency = 1

		-- Increment the counter
		keysCollected = keysCollected + 1

		print("Ключ собран: " .. touchedKey.Name .. ". Всего собрано: " .. keysCollected)

		-- Check if all three keys have been collected
		if keysCollected >= 3 then
			print("Все ключи собраны! Стена исчезнет.")
			WallClose.CanCollide = false
			WallClose.Transparency = 1
			WallClose:Destroy()
		end
	end
end

-- Connect the function to the 'Touched' event for each key
key1.Touched:Connect(function(otherPart)
	onKeyTouched(key1, otherPart)
end)

key2.Touched:Connect(function(otherPart)
	onKeyTouched(key2, otherPart)
end)

key3.Touched:Connect(function(otherPart)
	onKeyTouched(key3, otherPart)
end)
